@page "/cpars/{cparId}"
@model ATSAudit.Views.CPARs.ReadCPAR
@{
    ViewData["Title"] = $"Viewing CPAR - {Model.CPARId}";
}

<div class="container-fluid">
    <div class="form-group row" id="readCPARInitial">

        <div class="col-lg-12 col-xl-5">
            <div class="row">

                @* <input id="cparId" type="hidden" name="cparId" value="@Model.CPARId"> *@

                <div class="col-4">
                    <div >
                        <div class="form-text">Issued To</div>
                        <input id="issuedTo" name="issuedTo" class="form-control" type="text" value="@Model.Respondent" readonly>
                    </div>
                    <div>
                        <div class="form-text">Issued By</div>
                        <input name="issuedBy" class="form-control" type="text" value="@Model.Requestor" readonly>
                    </div>
                </div>

                <div class="col-4">
                    <div >
                        <div class="form-text">Issue Date</div>
                        <input name="issueDate" class="form-control" type="text" value="@Model.IssueDate" readonly>
                    </div>
                    <div >
                        <div class="form-text">Audit Date</div>
                        <input name="auditDate" class="form-control" type="text" @* value="@Model." *@ readonly>
                    </div>
                </div>

                <div class="col-4">
                    <div>
                        <div class="form-text">Response Due Date</div>
                        <input name="responseDueDate" class="form-control" type="text" value="@Model.ResponseDueDate.Value.ToShortDateString()" readonly>
                    </div>
                    <div >
                        <div class="form-text">CAR Control No.</div>
                        <input name="cparId" class="form-control" type="text" value="@Model.CPARId" readonly>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <div class="form-text text-center">Requirement: ISO 9001:2015 CLAUSE</div>
                    <textarea class="form-control" readonly>@Model.ISOClause</textarea>
                </div>
                <div class="col-12">
                    <div class="form-text text-center">Problem Statement</div>
                    <textarea class="form-control" readonly>@Model.ProblemStatement</textarea>
                </div>
            </div>

            <hr class="border border-2">

            <div id="readCPARRespondent">

                <fieldset id="readCPARRC">
                    @* <legend class="text-center form-text">Root Cause Analysis</legend> *@
                    <h6 class="form-text text-center">Root Cause Analysis</h6>
                    <div class="row" id="readCPARRootCause">
                        <div class="form-group respondent">
                            <div class="form-text">Method</div>
                            <input class="form-control" type="text" id="readCPARRCMethod" readonly />
                            <div class="form-text">Machine</div>
                            <input class="form-control" type="text" id="readCPARRCMachine" readonly />
                            <div class="form-text">Material</div>
                            <input class="form-control" type="text" id="readCPARRCMaterial" readonly />
                            <div class="form-text">Man</div>
                            <input class="form-control" type="text" id="readCPARRCMan" readonly />
                            <div class="form-text">Environment</div>
                            <input class="form-control" type="text" id="readCPARRCEnvironment" readonly />
                        </div>
                    </div>
                </fieldset>

            </div>

            <hr class="border border-2">

            <div class="form-group row respondent">
                <div class="col-4">
                    <div class="form-text">Prepared By</div>
                    <input class="form-control" type="text" id="readCPARFooterPreparedBy" readonly />
                </div>
                <div class="col-4">
                    <div class="form-text">Checked By</div>
                    <input class="form-control" type="text" id="readCPARFooterCheckedBy" readonly />
                </div>
                <div class="col-4">
                    <div class="form-text">Approved By</div>
                    <input class="form-control" type="text" id="readCPARFooterApprovedBy" readonly />
                </div>
            </div>

        </div>

        <div class="col-lg-12 col-xl-7 my-3">
            <nav>
                <div class="nav nav-tabs" id="dashboardTab" role="tablist">
                    <button class="nav-link active" id="correctionsTab" data-bs-toggle="tab" data-bs-target="#correctionsTabPane" type="button" role="tab">
                        Corrections
                    </button> 
                    <button class="nav-link" id="correctiveActionsTab" data-bs-toggle="tab" data-bs-target="#correctiveActionsTabPane" type="button" role="tab">
                        Corrective Actions
                    </button>
                    <button class="nav-link" id="preventiveActionsTab" data-bs-toggle="tab" data-bs-target="#preventiveActionsTabPane" type="button" role="tab">
                        Preventive Actions
                    </button>
                </div>
            </nav>

            <div class="tab-content">
                <div class="tab-pane m-4 show active" id="correctionsTabPane" role="tabpanel" tabindex="0">
                    <div class="row" id="readCPARCorrectionsTable"></div>
                    <button id="createCorrectionButton" class="form-control fa-solid fa-plus" data-bs-target="#createCorrection" data-bs-toggle="modal" />
                </div>  
                <div class="tab-pane m-4" id="correctiveActionsTabPane" role="tabpanel" tabindex="0">
                    <div class="row" id="readCPARCorrectiveActionsTable"></div>
                    <button id="createCorrectiveActionButton" class="form-control fa-solid fa-plus" data-bs-target="#createCorrectiveAction" data-bs-toggle="modal" />
                </div>
                <div class="tab-pane m-4" id="preventiveActionsTabPane" role="tabpanel" tabindex="0">
                    <div class="row" id="readCPARPreventiveActionsTable"></div>
                    <button id="createPreventiveActionButton" class="form-control col-3 fa-solid fa-plus" data-bs-target="#createPreventiveAction" data-bs-toggle="modal" />
                </div>
            </div>

        </div>
</div>

<div class="modal-footer" hidden>
    <button class="btn btn-primary" type="button" id="createConformitySubmit" data-bs-dismiss="modal">Submit</button>
</div>

<partial name="Partials/_UploadEvidenceModal"></partial>
<partial name="Partials/_ViewEvidenceModal"></partial>

<partial name="Partials/_CreateCorrectionModal"></partial>
<partial name="Partials/_CreateCorrectiveActionModal"></partial>
<partial name="Partials/_CreatePreventiveActionModal"></partial>

@section Scripts
{

    <script src="~/JS/Common.js"></script>
    <script src="~/JS/Evidence.js"></script>

    <script src="~/JS/CorrectionsTable.js"></script>
    <script src="~/JS/CorrectiveActionsTable.js"></script>
    <script src="~/JS/PreventiveActionsTable.js"></script>
    <script src="~/JS/ReadCPAR/ReadCPAR.js"></script>

}